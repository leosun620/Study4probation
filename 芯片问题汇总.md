芯片总结

1. 在流水线上传输的是整个packet还是头128 B？

   答：在流水线上的数据，其实通过packet parse engine提取报文中的头128字节来得到这个报文的描述符，这个描述符包括了EtherType，DIP，SIP，DMAC，SMAC....这些字段其实是报文的行为与特征的描述。而在流水线中我们传递的是这个描述结构体，而不是完整的报文信息。如果是整个报文信息进行流水线的操作，将会占用很大的应用消耗，同时后面的引擎并没有对这些数据流进行操作，所以在处理的时候我们只要将收到的报文缓存起来，提取其重要的描述符信息参与流水线的数据处理。

2. 各个引擎是不是都必须进行？

   答：各个引擎是相互独立的，并且都有开关进行控制，如果我们不需要进行三层路由，我们就可以将L3路由引擎关闭。

3. ​

   ​

# intelligent parser 

1. 全解析针对什么port？

   ​

2. HiGig 解析针对的什么port，其中有哪些关键字段，与全解析有什么区别？

# security engine 

不做重点理解

# L2 switch 

1. L2 switch 中的VLAN 分配是什么，端口这么对这些vlan id 处理？

   答：如果是 untag 报文，vlan模块将进行基于MAC的、基于子网的、基于协议的和基于端口的vlan分配。

2. 这里的优先级指的是什么？

   答：在分配vlan的时候，我们可以对报文添加优先级cos,这样报文可以决定是在出端口对应的8个cos队列中的哪一个，通过这个方式可以决定报文转发的优先级。

3. SMAC 是如何学习的？

   答：将（SMAC + VLANID）作为hash的索引在L2 Table（MAC表）查找，如果存在，则更新hit值；如果端口发生了变化，那么则对端口进行更新。如果不存在则根据CML位来决定芯片的自动学习，转发，丢弃，或者送CPU。

4. 查找DMAC的流程是什么？

   答：

   ​

5. AP 是什么？

6. STP是什么，怎么工作？


# L3 Switch

1. 如何进入这个引擎？ 

   答：首先要将这个L3路由引擎打开；其次当我们在L2进行DMAC查找的时候，发现L3 bit置位，那么就进入L3转发流程：

   + 首先对L3头部（128B）进行校验，校验和错误的包，就直接丢弃。
   + 然后在L3_Table中对SIP进行查找，如果没有查到，不处理，如果查到则更新命中位L3\_hit\_bit；
   + 进行DIP的查找，如果在主机路由表中没有查到，同时到子网路由表中查找，那么就会在子网路由表中进行最长子网匹配算法（LMP），如果还没有找到，就会将送CPU进行处理，如果在主机路由表或者子网路由表中找到了，将会得到下一跳的指针。包括了下一跳MAC地址，还有接口表的索引。在包转发出去的时候，将会用下一跳MAC地址替换DMAC，同时接口表中的MAC，vlan字段分别替换描述符中的SMAC，vlan。

# ContentAware Processor

1. FP能做什么？

   ​

2. FP引擎的特殊性，它能够匹配任意组合吗？如何进行关键字的组合?

   ​

3. FP有哪些动作?

   ​

4. FP内部是如何实现的？

   CAP也即是FP。它包括了五个部分：Intelligent protocol-aware selector，ContentAware lookup engine，ContentAware policy engine，ContentAware metering and statistic engine，ContentAware action resolution engine。

5. Hash 和TCAM的优缺点和不同点在哪里，应用场景又是如何分别应用在什么表项？

   + Hash：它是由Key-value的形式进行查找
   + TCAM：叫三态查找，拥有0,1，不关心这3个状态。它需要一个掩码，1表示关心各个状态，0表示忽略的这个状态。它的实现的功能是依据内容查找地址。由于它的硬件实现复杂要求高，因此价格也很高。

6. 在FP中CAM是如何进行查找的？

   首先FP（56500）中有16个CAM查找引擎。在入端口的时候，智能协议选择引擎对包中前128字节安装协议字段进行选择和标记，CAM查找引擎按照用户给的key匹配协议选择器中的内容，这16个CAM是并行进行查找，产生16个结果，如果不冲突则全部执行，如果冲突了则选择优先级高的行为执行（地址越低优先级越高）。

7. Hash查找又是怎么进行查找的？

   ​

8. Hash中key产生冲突了是如何解决。

   ​

9. TCAM作为LMP查找，应该如何设计？

   ​

10. Hash表一般是存放什么数据，数量大的话就适合存放Hash吗？

  ​

11. 精确的用什么查找，模糊的用什么查找？

    ​

12. Hash表为什么有hit位，TCAM需不需要？


# Buffer Management

1. buffer managemet主要的作用是什么？
   + 首先任何报文在芯片处理之前，都需要将自己的内容缓存在buffer management这里，buffer management 通过控制每个端口的数据流量情况，避免出现过度竞争，导致有的端口不能够得到调度进行数据的传送，饿死了。在宏观上使得每个端口都能够更加合理的利用这个流水线和buffer。

# Traffic Management

1. Queue与CoS之间的关系？

   每个出端口都拥有8个queue，这8个queue之间存在不同的CoS的优先级，优先级高的队列可以先发送。

2. Traffic Management的作用是什么，有什么功能？

   + Queue
   + Scheduling
   + Shaped 流量整形的目的是针对入口突然流量的处理，是的流量变得稍微平滑点。

3. 硬件时钟是什么？

   指的是硬件读取比特流的速度，因此在数据传输之前，硬件之间将会进行自协商，以相互都都能够接受的速率进行传输。


# Modification

1. Modification 具体指modify 哪些内容，依据什么modify，为什么要modify，意义何在？

   ​

   ​

2. 该引擎能否改变出端口，为什么，该功能在哪一步已经结束了？

   Modification并不能修改报文的出端口，在Buffer Manager engine已经到达出口了，所以无法再修改出端口。








​











